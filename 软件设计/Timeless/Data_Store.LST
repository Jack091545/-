C51 COMPILER V9.01   DATA_STORE                                                            04/30/2016 21:06:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE DATA_STORE
OBJECT MODULE PLACED IN Data_Store.OBJ
COMPILER INVOKED BY: D:\software\KEILC51\C51\BIN\C51.EXE Data_Store.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "stc12c5a60s2.h"
   2          #include "Data_Store.h"
   3          #include<intrins.h>
   4          
   5          
   6          #define CMD_IDLE 0
   7          #define CMD_READ 1
   8          #define CMD_PROGRAM 2
   9          #define CMD_ERASE 3
  10          
  11          #define ENABLE_IAP 0x82
  12          
  13          #define IAP_ADDRESS 0x0000
  14          
  15          
  16          
  17          void Delay(unsigned char n)
  18          {
  19   1              unsigned int x;
  20   1              while(n--)
  21   1              {
  22   2                      x = 0;
  23   2                      while(++x);
  24   2              }
  25   1      }
  26          
  27          void IAP_Idle(void)
  28          {
  29   1              IAP_CONTR = 0;
  30   1              IAP_CMD = 0;
  31   1              IAP_TRIG = 0;
  32   1              IAP_ADDRH = 0x80;
  33   1              IAP_ADDRL = 0x00;
  34   1      }
  35          
  36          unsigned char IAP_ReadByte(unsigned int addr)
  37          {
  38   1              unsigned char dat;
  39   1      
  40   1              IAP_CONTR = ENABLE_IAP;
  41   1              IAP_CMD = CMD_READ;
  42   1              IAP_ADDRL = addr;
  43   1              IAP_ADDRH = addr >> 8;
  44   1              IAP_TRIG = 0x5A;
  45   1              IAP_TRIG = 0XA5;
  46   1              _nop_();
  47   1      
  48   1              dat = IAP_DATA;
  49   1              IAP_Idle();
  50   1      
  51   1              return dat;
  52   1      }
  53          
  54          
  55          void IAP_ProgramByte(unsigned int addr,unsigned char dat)
C51 COMPILER V9.01   DATA_STORE                                                            04/30/2016 21:06:42 PAGE 2   

  56          {
  57   1              IAP_CONTR = ENABLE_IAP;
  58   1              IAP_CMD = CMD_PROGRAM;
  59   1              IAP_ADDRL = addr;
  60   1              IAP_ADDRH = addr >> 8;
  61   1              IAP_DATA = dat;
  62   1              IAP_TRIG = 0x5A;
  63   1              IAP_TRIG = 0XA5;
  64   1              _nop_();
  65   1      
  66   1      
  67   1              IAP_Idle();     
  68   1      }
  69          
  70          void IAP_EraseSector(unsigned int addr)
  71          {
  72   1              IAP_CONTR = ENABLE_IAP;
  73   1              IAP_CMD = CMD_ERASE;
  74   1              IAP_ADDRL = addr;
  75   1              IAP_ADDRH = addr >> 8;
  76   1              IAP_TRIG = 0x5A;
  77   1              IAP_TRIG = 0XA5;
  78   1              _nop_();
  79   1      
  80   1              IAP_Idle();             
  81   1      }
  82          
  83          
  84          
  85          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     98    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
